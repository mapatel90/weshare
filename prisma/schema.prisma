generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  relationMode = "prisma"
}

model blogs {
  id               Int      @id @default(autoincrement())
  created_by       Int?
  title       String?   @db.VarChar(255)
  date        DateTime @default(now())
  image       String?  @db.VarChar(255)
  description String?
  slug        String?   @db.VarChar(255)
  is_deleted       Int      @default(0)
  created_at       DateTime @default(now())
  updated_at       DateTime @default(now())
}

model cities {
  id         Int     @id @default(autoincrement())
  created_by Int?
  name       String     @db.VarChar(100)
  state_id   Int
  status     Int        @default(1)
  created_at DateTime   @default(now())
  updated_at DateTime   @default(now())
  projects   projects[]
  users      users[]
  lease_requests lease_requests[]

}

model contact_us {
  id           Int      @id @default(autoincrement())
  full_name    String   @db.VarChar(255)
  email        String   @db.VarChar(255)
  phone_number String?  @db.VarChar(20)
  subject      String   @db.VarChar(255)
  message      String
  project_id   Int?
  status       Int      @default(1)
  is_deleted   Int      @default(0)
  created_at   DateTime @default(now())
}

model contracts {
  id                   Int                   @id @default(autoincrement())
  offtaker_id          Int?
  project_id           Int?
  investor_id          Int?
  created_by           Int?
  contract_title       String                @db.VarChar(255)
  contract_description String?
  document_upload      String?               @db.VarChar(500)
  signed_document_upload String?             @db.VarChar(500)
  contract_date        DateTime?
  status               Int                   @default(0)
  is_deleted           Int                   @default(0)
  created_at           DateTime              @default(now())
  updated_at           DateTime              @default(now())
  rejectreason         String?               @db.VarChar(255)
  interested_investors interested_investors? @relation(fields: [investor_id], references: [id])
  users                users?                @relation(fields: [offtaker_id], references: [id])
  projects             projects?             @relation(fields: [project_id], references: [id])

}

model countries {
  id         Int        @id @default(autoincrement())
  created_by Int?
  name       String     @db.VarChar(100)
  code       String     @db.VarChar(5)
  status     Int        @default(1)
  created_at DateTime   @default(now())
  updated_at DateTime   @default(now())
  projects   projects[]
  users      users[]
  lease_requests lease_requests[]
}

model interested_investors {
  id           Int         @id @default(autoincrement())
  created_by   Int?
  project_id   Int?
  user_id      Int?
  full_name    String      @db.VarChar(255)
  email        String      @db.VarChar(150)
  phone_number String?     @db.VarChar(20)
  notes        String?
  status       Int         @default(1)
  is_deleted   Int         @default(0)
  created_at   DateTime    @default(now())
  updated_at   DateTime    @default(now())
  contracts    contracts[]
  projects     projects?   @relation(fields: [project_id], references: [id])
  users        users?      @relation(fields: [user_id], references: [id])
}

model inverter_data {
  id                  Int       @id @default(autoincrement())
  project_id          Int
  project_inverter_id Int?
  date                DateTime?
  time                String
  generate_kw         Float
  ac_frequency        Float?
  daily_yield         Float?
  annual_yield        Float?
  total_yield         Float?
  created_at          DateTime  @default(now())
  projects            projects  @relation(fields: [project_id], references: [id])
  project_inverters    project_inverters?  @relation(fields: [project_inverter_id], references: [id])

  @@map("inverter_data")
}

model inverter_type {
  id         Int    @id @default(autoincrement())
  created_by Int?
  type       String @db.VarChar(255)
  status     Int    @default(1)
  is_deleted Int    @default(0)

  inverters inverters[]
}

model inverters {
  id               Int    @id @default(autoincrement())
  created_by       Int?
  inverter_type_id Int?
  company_id       Int?
  phase_name       String? @db.VarChar(255)
  status           Int?          @default(1)
  is_deleted Int? @default(0)
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  inverter_type          inverter_type?       @relation(fields: [inverter_type_id], references: [id])
  inverter_company       inverter_company?    @relation(fields: [company_id], references: [id])

  project_inverters project_inverters[]
}

model inverter_company {
  id           Int    @id @default(autoincrement())
  created_by   Int?
  company_name String @db.VarChar(255)

  api_url    String? @db.VarChar(1000)
  api_key    String?  @db.VarChar(1000)
  secret_key String?  @db.VarChar(1000)

  status     Int? @default(1)
  api_status Int? @default(1)
  is_deleted Int? @default(0)

  created_at DateTime @default(now())
  updated_at DateTime @default(now())

  inverters inverters[]
}

model invoices {
  id                    Int      @id @default(autoincrement())
  created_by            Int?
  offtaker_id           Int
  project_id            Int
  billing_year          Int?      @default(0)
  billing_month         Int?      @default(0)
  invoice_number        String    @db.VarChar(255)
  invoice_prefix        String    @db.VarChar(255)
  invoice_date          DateTime  @db.Date
  due_date              DateTime? @db.Date
  currency              String    @db.VarChar(255)
  billing_adress_1      String    @db.VarChar(255)
  billing_adress_2      String    @db.VarChar(255)
  billing_city_id       Int?
  billing_state_id      Int?
  billing_country_id    Int?
  billing_zipcode       Int?
  sub_amount            Float     @default(0)
  tax_id                Int?      @default(0)
  tax_amount            Float     @default(0)
  total_amount          Float     @default(0)
  notes                 String?    @db.VarChar(255)
  terms_and_conditions  String?    @db.VarChar(255)
  qr_code_url           String?    @db.VarChar(900)
  status                Int       @default(0)
  is_deleted            Int       @default(0)
  created_at            DateTime  @default(now())
  updated_at            DateTime  @default(now())

  users       users    @relation(fields: [offtaker_id], references: [id])
  projects    projects @relation(fields: [project_id], references: [id])
  taxes       taxes?   @relation(fields: [tax_id], references: [id])
  invoice_items invoice_items[]
  payments  payments[]
  payouts   payouts[]
}

model invoice_items {
  id          Int      @id @default(autoincrement())
  created_by  Int?
  invoice_id  Int
  item        String    @db.VarChar(255)
  description String    @db.VarChar(255)
  unit        Float
  price       Float
  item_total  Float
  created_at  DateTime @default(now())
  
  invoices    invoices    @relation(fields: [invoice_id], references: [id])
}

model lease_requests {
  id           Int      @id @default(autoincrement())
  full_name    String   @db.VarChar(255)
  email        String   @db.VarChar(255)
  phone_number String?  @db.VarChar(20)
  country_id   Int?
  state_id     Int?
  city_id      Int?
  address      String?  @db.VarChar(500)
  subject      String?  @db.VarChar(255)
  message      String
  status       Int      @default(1)
  is_deleted   Int      @default(0)
  created_at   DateTime @default(now())
  updated_at   DateTime @default(now())
  countries      countries? @relation(fields: [country_id], references: [id])
  states        states?    @relation(fields: [state_id], references: [id])
  cities         cities?    @relation(fields: [city_id], references: [id])
}

model news {
  id               Int      @id @default(autoincrement())
  created_by       Int?
  title       String?   @db.VarChar(255)
  date        DateTime @default(now())
  image       String?  @db.VarChar(255)
  description String?
  slug        String?   @db.VarChar(255)
  is_deleted       Int      @default(0)
  created_at       DateTime @default(now())
  updated_at       DateTime @default(now())
}

model password_reset_tokens {
  id         Int      @id @default(autoincrement())
  created_by Int?
  username   String   @db.VarChar(150)
  token      String   @db.VarChar(255)
  expires_at DateTime
  used       Boolean  @default(false)
  created_at DateTime @default(now())
}

model payments {
  id          Int      @id @default(autoincrement())
  created_by   Int?
  invoice_id  Int      @default(0)
  offtaker_id Int      @default(0)
  amount      Float    @default(0)
  ss_url      String?   @db.VarChar(150)
  status      Int      @default(0)
  is_deleted  Int      @default(0)
  created_at  DateTime @default(now())
  updated_at  DateTime @default(now())
  users       users    @relation(fields: [offtaker_id], references: [id])
  invoices    invoices @relation(fields: [invoice_id], references: [id])
}

model project_data {
  id         Int      @id @default(autoincrement())
  project_id Int
  wind_spd             String?                @db.VarChar(255)
  wind_dir             String?                @db.VarChar(255)
  cond_txtd            String?                @db.VarChar(255)
  cond_txtn            String?                @db.VarChar(255)
  hum                  String?                @db.VarChar(255)
  tmp_max              String?                @db.VarChar(255)
  tmp_min              String?                @db.VarChar(255)
  tmp_unit             String?                @db.VarChar(255)
  sr                   String?                @db.VarChar(255)
  ss                   String?                @db.VarChar(255)
  home_load_today_energy Float?               @default(0)
  day_energy           Float?                 @default(0)
  month_energy         Float?                 @default(0)
  year_energy          Float?                 @default(0)
  total_energy         Float?                 @default(0)
  day_in_come          String?                @db.VarChar(255)
  p_sum                Float?                 @default(0)
  grid_purchased_day_energy Float?            @default(0)
  family_load_power    Float?                 @default(0)
  power                Float?                 @default(0)
  battery_charge_energy Float?                @default(0)
  battery_discharge_energy Float?             @default(0)
  total_grid_battery  Float?                  @default(0)
  battery_power       Float?                  @default(0)
  battery_percent     Float?                  @default(0)
  battery_direction   Int                     @default(0)
  epm_type            Int                     @default(0)
  generator_power     Float                   @default(0)
  generator_today_energy Float                @default(0)
  power_station_num_tree Float                @default(0)
  power_station_avoided_co2 Float             @default(0)
  power_station_avoided_tce Float             @default(0)
  project_solis_status  Int?                  @default(0)
  created_at DateTime @default(now())
  

  projects      projects @relation(fields: [project_id], references: [id])
}

model project_energy_data {
  id         Int      @id @default(autoincrement())
  project_id Int
  date       DateTime
  time       String
  pv         Float
  grid       Float
  load       Float
  created_at DateTime @default(now())

  projects      projects @relation(fields: [project_id], references: [id])
}


model project_energy_days_data {
  id         Int      @id @default(autoincrement())
  project_id Int
  date       DateTime @db.Date
  energy     Float
  grid_purchased_energy Float
  consume_energy  Float
  full_hour Float
  money     Float
  battery_charge_energy Float
  battery_discharge_energy Float
  home_grid_energy Float
  back_up_energy Float
  created_at DateTime @default(now())

  projects      projects @relation(fields: [project_id], references: [id])
}

model project_images {
  id         Int      @id @default(autoincrement())
  created_by Int?
  project_id Int
  path       String   @db.VarChar(500)
  default    Int      @default(0)
  created_at DateTime @default(now())
  updated_at DateTime @default(now())
  projects   projects @relation(fields: [project_id], references: [id])

}

model project_inverters {
  id                     Int       @id @default(autoincrement())
  project_id             Int
  inverter_id            Int
  created_by             Int?
  kilowatt               Float?    @default(0.0)
  inverter_serial_number String?   @db.VarChar(255)
  inverter_name          String?   @db.VarChar(255)
  model                  String?   @db.VarChar(255)
  version                String?   @db.VarChar(255)
  in_warranty            Int       @default(0)
  warranty_expire_date   DateTime?
  day_energy             Float?                 @default(0)
  month_energy           Float?                 @default(0)
  year_energy            Float?                 @default(0)
  total_energy           Float?                 @default(0)
  status                 Int       @default(0)
  state_exception_flag   Int?       @default(0)
  is_deleted             Int       @default(0)
  created_at             DateTime  @default(now())
  updated_at             DateTime  @default(now())
  inverters              inverters @relation(fields: [inverter_id], references: [id])
  projects               projects  @relation(fields: [project_id], references: [id])
  inverter_data    inverter_data[] 

  @@map("project_inverters")
}


model project_types {
  id         Int        @id @default(autoincrement())
  created_by Int?
  type_name  String     @db.VarChar(255)
  status     Int        @default(0)
  is_deleted Int        @default(0)
  created_at DateTime   @default(now())
  updated_at DateTime   @default(now())
  projects   projects[]
}

model projects {
  id                   Int                    @id @default(autoincrement())
  created_by           Int?
  offtaker_id          Int?
  investor_id          Int?
  project_name         String                 @db.VarChar(255)
  project_slug         String                 @db.VarChar(255)
  project_type_id      Int                    @default(0)
  product_code         String?                @db.VarChar(255)
  project_description  String?
  asking_price         String?                @db.VarChar(255)
  lease_term           Int?
  project_image        String?                @db.VarChar(500)
  project_size         String?                @db.VarChar(255)
  project_start_date   DateTime?
  project_close_date   DateTime?
  project_location     String?                @db.VarChar(500)
  weshare_price_kwh    Float?
  evn_price_kwh        Float?
  solis_plant_id       String?                @db.VarChar(255)
  address_1            String?                @db.VarChar(255)
  address_2            String?                @db.VarChar(255)
  city_id              Int?
  state_id             Int?
  country_id           Int?
  zipcode              String?                @db.VarChar(20)
  investor_profit      String?                 @db.VarChar(255)
  weshare_profit       String?                 @db.VarChar(255)
  meter_url            String?                @db.VarChar(255)
  sim_number           String?                @db.VarChar(255)
  sim_start_date       DateTime?
  sim_expire_date      DateTime?
  project_status_id    Int?                   @default(1)
  is_deleted           Int                    @default(0)
  created_at           DateTime               @default(now())
  updated_at           DateTime
  contracts            contracts[]
  interested_investors interested_investors[]
  inverter_data        inverter_data[]
  invoices             invoices[]
  project_images       project_images[]
  project_inverters    project_inverters[]
  cities               cities?                @relation(fields: [city_id], references: [id])
  countries            countries?             @relation(fields: [country_id], references: [id])
  offtaker             users?                 @relation(fields: [offtaker_id], references: [id])
  project_types        project_types          @relation(fields: [project_type_id], references: [id])
  states               states?                @relation(fields: [state_id], references: [id])
  project_status       project_status?        @relation(fields: [project_status_id], references: [id])
  investor             users?                 @relation("ProjectInvestor", fields: [investor_id], references: [id])
  testimonials         testimonials[]
  project_data         project_data[]
  project_energy_data  project_energy_data[]
  project_energy_days_data project_energy_days_data[]
  payouts              payouts[]
  project_documents    project_documents[]
}

model roles {
  id         Int      @id @default(autoincrement())
  created_by Int?
  name       String   @db.VarChar(100)
  status     Int      @default(1)
  is_deleted Int      @default(0)
  created_at DateTime @default(now())
  updated_at DateTime @default(now())
}

model settings {
  id         Int      @id @default(autoincrement())
  created_by Int?
  key        String   @db.VarChar(255)
  value      String
  created_at DateTime @default(now())
  updated_at DateTime @default(now())
}

model states {
  id         Int        @id @default(autoincrement())
  created_by Int?
  name       String     @db.VarChar(100)
  code       String?    @db.VarChar(10)
  country_id Int
  status     Int        @default(1)
  created_at DateTime   @default(now())
  updated_at DateTime   @default(now())
  projects   projects[]
  users      users[]
  lease_requests lease_requests[]

}

model testimonials {
  id            Int      @id @default(autoincrement())
  created_by    Int?
  project_id    Int
  offtaker_id   Int
  image         String?  @db.VarChar(255)
  description   String?
  review_status Int      @default(1)
  is_deleted    Int      @default(0)
  created_at    DateTime @default(now())
  updated_at    DateTime @default(now())
  users         users    @relation(fields: [offtaker_id], references: [id])
  projects      projects @relation(fields: [project_id], references: [id])
}

model users {
  id                   Int                    @id @default(autoincrement())
  created_by           Int?
  role_id              Int                    @default(3)
  username             String                 @db.VarChar(150)
  full_name            String                 @db.VarChar(100)
  email                String                 @db.VarChar(150)
  phone_number         String?                @db.VarChar(20)
  password             String                 @db.VarChar(255)
  user_image           String?                @db.VarChar(500)
  address_1            String?                @db.VarChar(255)
  address_2            String?                @db.VarChar(255)
  city_id              Int?
  state_id             Int?
  country_id           Int?
  zipcode              String?                @db.VarChar(20)
  qr_code              String?                @db.VarChar(500)
  language             String?                @db.VarChar(255)
  email_verified       Int                    @default(0)
  email_verified_at    DateTime?
  email_verify_token   String?                @db.VarChar(255)
  email_verify_expires DateTime?
  status               Int                    @default(1)
  is_deleted           Int                    @default(0)
  terms_accepted       Int                    @default(1)
  created_at           DateTime               @default(now())
  updated_at           DateTime               @default(now())
  contracts            contracts[]
  interested_investors interested_investors[]
  invoices             invoices[]
  payments             payments[]
  projects             projects[]
  testimonials         testimonials[]
  cities               cities?                @relation(fields: [city_id], references: [id])
  countries            countries?             @relation(fields: [country_id], references: [id])
  states               states?                @relation(fields: [state_id], references: [id])
  notifications        notifications[]        @relation("NotificationUser")
  created_notifications notifications[]       @relation("NotificationCreator")
  payouts              payouts[]
  investor_projects     projects[] @relation("ProjectInvestor")
}

model taxes {
  id                   Int                    @id @default(autoincrement())
  created_by           Int?
  name                 String                 @db.VarChar(255)
  value                Float                  @default(0)
  is_deleted           Int                    @default(0)
  created_at           DateTime               @default(now())
  updated_at           DateTime               @default(now())

  invoices             invoices[]
}

model notifications {
  id                   Int                    @id @default(autoincrement())
  user_id              Int                    @default(0)
  title                String
  message              String?
  module_type          String?                
  module_id            Int?
  action_url           String?
  is_read              Int                    @default(0)
  created_at           DateTime               @default(now())
  created_by           Int                    @default(0)

  users                users?                 @relation("NotificationUser", fields: [user_id], references: [id])
  created_users        users?                 @relation("NotificationCreator", fields: [created_by], references: [id])
}
model project_status {
  id                  Int                    @id @default(autoincrement())
  name                String?
  is_deleted          Int                    @default(0)

  projects   projects[]
}

model project_documents {
  id            Int       @id @default(autoincrement())
  project_id    Int? 
  title         String?    @db.VarChar(255)
  amount        Float?     @default(0)
  notes         String?    @db.VarChar(255)
  document      String?     @db.VarChar(500)
  created_by    Int?        @default(0)
  created_at    DateTime?   @default(now())

  projects      projects? @relation(fields: [project_id], references: [id])
}

model email_template {
  id          Int      @id @default(autoincrement())
  title       String   @db.VarChar(255)
  slug        String   @db.VarChar(255)
  content_en  String?
  content_vi  String?
  subject     String   @db.VarChar(255)
  created_by  Int?
  created_at  DateTime @default(now())
}

model payouts {
  id              Int      @id @default(autoincrement())
  payout_number   String    @db.VarChar(255)
  payout_prefix   String    @db.VarChar(255)
  invoice_id      Int
  investor_id     Int
  project_id      Int
  invoice_amount  Float     @default(0)
  investor_percent Float    @default(0)
  payout_amount   Float     @default(0)
  document        String?   @db.VarChar(255)

  status          String   @default("pending") 
  transaction_id  String? // bank txn id / stripe id
  payout_date     DateTime?
  created_at      DateTime @default(now())

  invoices  invoices    @relation(fields: [invoice_id], references: [id])
  users     users       @relation(fields: [investor_id], references: [id])
  projects  projects    @relation(fields: [project_id], references: [id])
}